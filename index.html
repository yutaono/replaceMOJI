<!DOCTYPE html>
<html lang="ja" manifest="site.appcache">
<!-- http://yonows.web.fc2.com/countmoji/ -->
<head>
	<meta charset="UTF-8" />
	<title>replaceMOJI | 文字列を検索・置換する</title>
	<link rel="apple-touch-icon-precomposed" href="./apple-touch-icon-precomposed.png"/>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/jquery.mobile-1.0rc1.min.css" />
	<link rel="stylesheet" href="css/style.css" />
	<script src="js/jquery-1.6.4.min.js"></script>
	<script src="js/jquery.mobile-1.0rc1.min.js"></script>

	<script type="text/javascript">

		function replaceMoji(str, before, after){
			var reg = new RegExp(before, "g");
			len = str.split(before).length-1;
			$('textarea#memo').val(str.replace(reg, after));
			$('p#replaceNum').text(len+"ヶ所、置換しました");
		}

		function saveText(hash, text){
			localStorage.setItem(hash, text);
		}

		// function saveTexts(){
		// 	saveText('btext', $('textarea#memo').val());
		// 	saveText('bbefore', $('input#before').val());
		// 	saveText('bafter', $('input#after').val());
		// }

		$(function(){
			// var btext = localStorage.getItem("btext");
			// if(btext != null){
			// 	$('textarea#memo').val(btext);
			// }
			// var bbefore = localStorage.getItem("bbefore");
			// if(bbefore != null){
			// 	$('input#before').val(bbefore);
			// }
			// var bafter = localStorage.getItem("bafter");
			// if(bafter != null){
			// 	$('textarea#memo').val(bafter);
			// }
			// $('textarea#memo').bind('keydown keyup keypress change', function(){
			// 	saveText('btext', $('textarea#memo').val());
			// });
			// $('input#before:text').change( function(){
			// 	saveText('bbefore', $('input#before').val());
			// });
			// $('input#after:text').change( function(){
			// 	saveText('bafter', $('input#after').val());
			// });

			$('input#replace').click(function(){
				var text = $('textarea#memo').val();
				var before = $('input#before').val();
				var after = $('input#after').val();

				if(text != '' && before!='' && after!=''){
					saveText('btext', text);
					replaceMoji(text, before, after);
				}
			});

			$('input#return').click(function(){
				var body = localStorage.getItem('btext');
				if(body != null){
					$('textarea#memo').val(body);
				}

			});
		});
	</script>
</head>

<body>
	<!--///////トップページ///////-->
	<div data-role="page" id="top">
		<div id="header" data-role="header" class="toppage">
			<h1>replaceMOJI</h1>
			<p>文字列を置き換える</p>
		</div>

		<div data-role="content">
			<textarea id="memo" placeholder="テキストを入力してください。"></textarea>
			<input type="text" id="before" placeholder="置換する文字列">
			<input type="text" id="after" placeholder="置換後の文字列">

			<p id="replaceNum">0ヶ所、置換しました。</p>
			<input id="replace" type="button" value="置換する" />
			<input id="return" type="button" value="もどす" />

		</div>

		<script type="text/javascript"><!--
		google_ad_client = "ca-pub-3518313162149167";
		/* foriphone */
		google_ad_slot = "7557764836";
		google_ad_width = 320;
		google_ad_height = 50;
//-->
</script>

<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>

<div id="footer" data-role="footer">
	<p></p>
</div>

</div>
</body>
</html>